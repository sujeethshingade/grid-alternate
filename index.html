<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Grid Component</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <div class="data-grid-container" id="gridContainer"></div>

    <script type="module">
      import { DataGrid } from "./data-grid.js";

      // Store original fetch before overriding
      const originalFetch = window.fetch;

      // Override fetch to mock API calls
      window.fetch = async function (url) {
        if (!url.includes("/api/files")) return originalFetch(url);

        try {
          const response = await originalFetch("./sample-data.json");
          const jsonData = await response.json();

          // Parse URL parameters for pagination
          const params = new URL(url, location.origin).searchParams;
          const offset = parseInt(params.get("offset")) || 0;
          const limit = parseInt(params.get("limit")) || 20;

          // Return paginated response
          return new Response(
            JSON.stringify({
              data: jsonData.data?.slice(offset, offset + limit) || [],
              total: jsonData.data?.length || 0,
              offset,
              limit,
            }),
            {
              status: 200,
              headers: { "Content-Type": "application/json" },
            }
          );
        } catch (error) {
          console.error("Error loading mock data:", error);
          return new Response(JSON.stringify({ data: [], total: 0 }), {
            status: 500,
          });
        }
      };

      // Initialize data grid
      new DataGrid({
        container: document.getElementById("gridContainer"),
        apiEndpoint: "/api/files",
        columns: [
          { key: "actions", label: "Actions" },
          { key: "name", label: "Name" },
          { key: "type", label: "Type" },
          { key: "modified", label: "Modified" },
          { key: "modifiedBy", label: "Modified By" },
          { key: "fileSize", label: "File Size" },
        ],
      });
    </script>
  </body>
</html>
